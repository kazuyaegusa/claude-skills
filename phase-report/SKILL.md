# フェーズ完了レポート自動生成

**このスキルは完全自動実行である。ユーザーへの確認・承認・質問を一切行わず、全ステップを自動で完了させること。**

## 自動実行ルール（厳守）

- ユーザーへの確認・承認を **一切求めない**
- レポート内容の確認も **求めない**
- コミット前の確認も **求めない**
- git リポジトリが存在しない場合は `git init` + `gh repo create` を **自動実行する**
- リモートリポジトリが未設定の場合も **自動作成する**
- `.gitignore` に明示的に除外されていないファイルは全て **コミットに含める**
- コミットメッセージは **自動生成する**
- `git push` まで **自動で完了する**

## 実行手順

以下の全ステップを確認なしで自動実行する:

### 1. Git リポジトリの確認・作成

```
if git リポジトリが存在しない:
    git init
    gh repo create --private --source=. --push
elif リモートが未設定:
    gh repo create --private --source=. --push
```

### 2. 変更内容の分析

- `git log` で前回のフェーズ完了コミット以降の全コミットを取得する
- 前回のフェーズ完了コミットがない場合は全コミットを対象とする
- `git diff` で変更されたファイルと差分の統計を取得する
- `git status` で未コミットの変更を確認する
- 変更ファイルをカテゴリ分けする（core、app_skills、tests、docs 等）

### 3. テスト結果の取得

- `tests/` ディレクトリが存在する場合: `pytest tests/ -v --tb=short` を実行し、結果を記録する
- 存在しない場合: 「テストディレクトリなし」と記録する

### 4. レポート生成

以下の構成で `docs/` にマークダウンファイルを作成する:

- ファイル名: `docs/phase{N}_{内容の英語要約}_report.md`
- フェーズ番号は既存のフェーズレポートから自動判定する（なければ Phase 1）
- 内容:
  - 実施日、環境情報
  - 概要（何をしたか、なぜしたか）
  - 変更内容の詳細（ファイル一覧、追加/削除行数、主要な変更点）
  - テスト結果（pytest の結果サマリー、またはテストなしの旨）
  - 実環境検証結果（手動テストを実施した場合はその結果）
  - 発見された問題・今後の課題
  - 次のフェーズへの申し送り事項

### 5. CLAUDE.md の更新

- プロジェクトの CLAUDE.md が存在する場合、現在のフェーズの状態を「完了」に更新する
- 存在しない場合はスキップする

### 6. コミット・プッシュ（確認なしで自動実行）

- 未コミットの変更がある場合は **確認なしで** 一緒にコミットする
- レポートファイルと CLAUDE.md をステージングする
- コミットメッセージ: `Phase {N} 完了レポート: {概要}`
- `git push origin {current_branch}` でプッシュする
- プッシュに失敗した場合は `git push -u origin {current_branch}` を試行する

## 注意事項

- レポートは日本語で書く
- 推測せず、実際の git diff とテスト結果に基づいて書く
- ユーザーから手動テスト結果の報告がある場合は、それも含める
- **繰り返し: ユーザーへの確認は一切しない。全て自動で実行して完了させる。**
